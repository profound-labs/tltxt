<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>TLTXT Bookmarklet</title>
        <meta name="description" content="TLTXT Bookmarklet">
        <meta name="viewport" content="width=device-width, initial-scale=1">
    </head>
    <body>
        <h1>TLTXT Bookmarklet</h1>
        <p>Copy text into tldraw.com boards</p>
        <p>Drag this bookmarklet onto your bookmarks bar:</p>

        <p>
            <a id="output-link" href="javascript:(async%20function()%7B%0A%0A%0A%0A%0A%0A%0Aconst%20START_POS_X%20=%20200;%0Aconst%20START_POS_Y%20=%20100;%0Aconst%20SPACE_X%20=%2035;%0Aconst%20SPACE_Y%20=%20120;%0Aconst%20TEXT_MAX_CHAR_WIDTH%20=%2060;%0Aconst%20TEXT_SIZE_STYLE%20=%20'm';%0A%0Afunction%20reflow_text(text,%20max_width,%20add_blanks%20=%20false)%20%7B%0A%20%20%0A%20%20const%20paragraphs%20=%20text.split(/%5Cn%5Cs*%5Cn/);%0A%0A%20%20%0A%20%20const%20processed_paragraphs%20=%20paragraphs.map(paragraph%20=%3E%20%7B%0A%20%20%20%20const%20words%20=%20paragraph.split(/%5Cs+/);%0A%20%20%20%20const%20lines%20=%20%5B%5D;%0A%20%20%20%20let%20current_line%20=%20'';%0A%20%20%20%20let%20current_width%20=%200;%0A%0A%20%20%20%20for%20(const%20word%20of%20words)%20%7B%0A%20%20%20%20%20%20const%20word_width%20=%20word.length;%0A%0A%20%20%20%20%20%20if%20(current_width%20+%20word_width%20+%201%20%3E%20max_width)%20%7B%0A%20%20%20%20%20%20%20%20lines.push(current_line.trim());%0A%20%20%20%20%20%20%20%20current_line%20=%20word;%0A%20%20%20%20%20%20%20%20current_width%20=%20word_width;%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20if%20(current_line%20!==%20'')%20%7B%0A%20%20%20%20%20%20%20%20%20%20current_line%20+=%20'%20';%0A%20%20%20%20%20%20%20%20%20%20current_width++;%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20current_line%20+=%20word;%0A%20%20%20%20%20%20%20%20current_width%20+=%20word_width;%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20if%20(current_line%20!==%20'')%20%7B%0A%20%20%20%20%20%20lines.push(current_line.trim());%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20lines.join('%5Cn');%0A%20%20%7D);%0A%0A%20%20let%20ret_text%20=%20%22%22;%0A%0A%20%20if%20(add_blanks)%20%7B%0A%20%20%20%20%0A%20%20%20%20ret_text%20=%20processed_paragraphs.join('%5Cn%5Cn');%0A%20%20%7D%20else%20%7B%0A%20%20%20%20ret_text%20=%20processed_paragraphs.join('%5Cn');%0A%20%20%7D%0A%0A%20%20return%20ret_text;%0A%7D%0A%0Afunction%20tldraw_text_inject(text)%20%7B%0A%20%20%0A%20%20if%20(!window.app)%20%7B%0A%20%20%20%20alert(%22TLDRAW%20app%20not%20found.%20Please%20make%20sure%20you're%20on%20the%20tldraw.com%20website.%22);%0A%20%20%20%20return;%0A%20%20%7D%0A%0A%20%20const%20app%20=%20window.app;%0A%0A%20%20const%20lines%20=%20reflow_text(text,%20TEXT_MAX_CHAR_WIDTH).split(%22%5Cn%22);%0A%0A%20%20var%20cur_x%20=%20START_POS_X;%0A%20%20var%20cur_y%20=%20START_POS_Y;%0A%0A%20%20var%20date_now%20=%20%60$%7BDate.now()%7D%60;%0A%0A%20%20lines.forEach(function%20(line,%20line_idx)%20%7B%0A%20%20%20%20var%20words%20=%20line.split(/%5Cs+/);%0A%20%20%20%20var%20shape_id%20=%20%22%22;%0A%0A%20%20%20%20words.forEach(function%20(word,%20word_idx)%20%7B%0A%0A%20%20%20%20%20%20shape_id%20=%20%22shape:text-%22%20+%20date_now%20+%20%22_%22%20+%20line_idx%20+%20%22_%22%20+%20word_idx;%0A%0A%20%20%20%20%20%20shape%20=%20app.createShape(%7B%0A%20%20%20%20%20%20%20%20type:%20%22text%22,%0A%20%20%20%20%20%20%20%20id:%20shape_id,%0A%20%20%20%20%20%20%20%20x:%20cur_x,%0A%20%20%20%20%20%20%20%20y:%20cur_y,%0A%20%20%20%20%20%20%20%20props:%20%7B%0A%20%20%20%20%20%20%20%20%20%20text:%20word,%0A%20%20%20%20%20%20%20%20%20%20size:%20TEXT_SIZE_STYLE,%20%0A%20%20%20%20%20%20%20%20%20%20color:%20'white',%20%0A%20%20%20%20%20%20%20%20%20%20font:%20'serif',%20%0A%20%20%20%20%20%20%20%20%20%20textAlign:%20'start',%20%0A%20%20%20%20%20%20%20%20%7D,%0A%20%20%20%20%20%20%7D);%0A%0A%20%20%20%20%20%20cur_x%20=%20window.editor.getShapePageBounds(shape_id).maxX%20+%20SPACE_X;%0A%0A%20%20%20%20%7D);%0A%0A%20%20%20%20cur_x%20=%20START_POS_X;%0A%20%20%20%20cur_y%20=%20window.editor.getShapePageBounds(shape_id).maxY%20+%20SPACE_Y;%0A%0A%20%20%7D);%0A%7D%0A%0Anavigator.clipboard%0A%20%20%20%20.readText()%0A%20%20%20%20.then((text)%20=%3E%20tldraw_text_inject(text));%0A%7D)()" class="bookmarklet-name mdl-color--primary mdl-color-text--accent-contrast">TLTXT</a>
        </p>

        <p>Copy some text, change tabs to tldraw.com and click on the bookmarklet. </p>
        <p>The code takes the clipboard text, breaks it to words and inserts them into a tldraw board.</p>
    </body>
</html>
