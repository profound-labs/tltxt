<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>TLTXT Bookmarklet</title>
        <meta name="description" content="TLTXT Bookmarklet">
        <meta name="viewport" content="width=device-width, initial-scale=1">
    </head>
    <body>
        <h1>TLTXT Bookmarklet</h1>
        <p>Copy text into tldraw.com boards</p>
        <p>Drag this bookmarklet onto your bookmarks bar:</p>

        <p>
            <a id="output-link" href="javascript:(async%20function()%7B%0A%0A%0A%0A%0A%0A%0Avar%20START_POS_X%20=%20200;%0Avar%20START_POS_Y%20=%20100;%0Avar%20SPACE_X%20=%2035;%0Avar%20SPACE_Y%20=%20120;%0Avar%20WRAP_TEXT%20=%20true;%0Avar%20TEXT_MAX_CHAR_WIDTH%20=%2060;%0Avar%20TEXT_COLOR%20=%20'white';%0Avar%20TEXT_SIZE_STYLE%20=%20'm';%0Avar%20ADD_BLANK_LINES%20=%20false;%0Avar%20INSERT_TEXT%20=%20'';%0A%0Afunction%20reflow_text(text,%20max_width,%20add_blank_lines%20=%20false)%20%7B%0A%20%20%0A%20%20const%20paragraphs%20=%20text.split(/%5Cn%5Cs*%5Cn/);%0A%0A%20%20%0A%20%20const%20processed_paragraphs%20=%20paragraphs.map(paragraph%20=%3E%20%7B%0A%20%20%20%20const%20words%20=%20paragraph.split(/%5Cs+/);%0A%20%20%20%20const%20lines%20=%20%5B%5D;%0A%20%20%20%20let%20current_line%20=%20'';%0A%20%20%20%20let%20current_width%20=%200;%0A%0A%20%20%20%20for%20(const%20word%20of%20words)%20%7B%0A%20%20%20%20%20%20const%20word_width%20=%20word.length;%0A%0A%20%20%20%20%20%20if%20(current_width%20+%20word_width%20+%201%20%3E%20max_width)%20%7B%0A%20%20%20%20%20%20%20%20lines.push(current_line.trim());%0A%20%20%20%20%20%20%20%20current_line%20=%20word;%0A%20%20%20%20%20%20%20%20current_width%20=%20word_width;%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20if%20(current_line%20!==%20'')%20%7B%0A%20%20%20%20%20%20%20%20%20%20current_line%20+=%20'%20';%0A%20%20%20%20%20%20%20%20%20%20current_width++;%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20current_line%20+=%20word;%0A%20%20%20%20%20%20%20%20current_width%20+=%20word_width;%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%0A%20%20%20%20if%20(current_line%20!==%20'')%20%7B%0A%20%20%20%20%20%20lines.push(current_line.trim());%0A%20%20%20%20%7D%0A%0A%20%20%20%20return%20lines.join('%5Cn');%0A%20%20%7D);%0A%0A%20%20let%20ret_text%20=%20%22%22;%0A%0A%20%20if%20(add_blank_lines)%20%7B%0A%20%20%20%20%0A%20%20%20%20ret_text%20=%20processed_paragraphs.join('%5Cn%5Cn');%0A%20%20%7D%20else%20%7B%0A%20%20%20%20ret_text%20=%20processed_paragraphs.join('%5Cn');%0A%20%20%7D%0A%0A%20%20return%20ret_text;%0A%7D%0A%0Afunction%20tldraw_text_insert(text)%20%7B%0A%20%20%0A%20%20if%20(!window.app)%20%7B%0A%20%20%20%20alert(%22TLDRAW%20app%20not%20found.%20Please%20make%20sure%20you're%20on%20the%20tldraw.com%20website.%22);%0A%20%20%20%20return;%0A%20%20%7D%0A%0A%20%20const%20app%20=%20window.app;%0A%0A%20%20var%20lines%20=%20%5B%5D;%0A%0A%20%20if%20(WRAP_TEXT)%20%7B%0A%20%20%20%20lines%20=%20reflow_text(text,%20TEXT_MAX_CHAR_WIDTH,%20ADD_BLANK_LINES).split(%22%5Cn%22);%0A%20%20%7D%20else%20%7B%0A%20%20%20%20lines%20=%20text.split(%22%5Cn%22);%0A%20%20%7D%0A%0A%20%20var%20cur_x%20=%20START_POS_X;%0A%20%20var%20cur_y%20=%20START_POS_Y;%0A%0A%20%20var%20date_now%20=%20%60$%7BDate.now()%7D%60;%0A%0A%20%20lines.forEach(function%20(line,%20line_idx)%20%7B%0A%20%20%20%20var%20words%20=%20line.split(/%5Cs+/);%0A%20%20%20%20var%20shape_id%20=%20%22%22;%0A%0A%20%20%20%20words.forEach(function%20(word,%20word_idx)%20%7B%0A%0A%20%20%20%20%20%20shape_id%20=%20%22shape:text-%22%20+%20date_now%20+%20%22_%22%20+%20line_idx%20+%20%22_%22%20+%20word_idx;%0A%0A%20%20%20%20%20%20shape%20=%20app.createShape(%7B%0A%20%20%20%20%20%20%20%20type:%20%22text%22,%0A%20%20%20%20%20%20%20%20id:%20shape_id,%0A%20%20%20%20%20%20%20%20x:%20cur_x,%0A%20%20%20%20%20%20%20%20y:%20cur_y,%0A%20%20%20%20%20%20%20%20props:%20%7B%0A%20%20%20%20%20%20%20%20%20%20text:%20word,%0A%20%20%20%20%20%20%20%20%20%20size:%20TEXT_SIZE_STYLE,%20%0A%20%20%20%20%20%20%20%20%20%20color:%20TEXT_COLOR,%20%0A%20%20%20%20%20%20%20%20%20%20font:%20'serif',%20%0A%20%20%20%20%20%20%20%20%20%20textAlign:%20'start',%20%0A%20%20%20%20%20%20%20%20%7D,%0A%20%20%20%20%20%20%7D);%0A%0A%20%20%20%20%20%20cur_x%20=%20window.editor.getShapePageBounds(shape_id).maxX%20+%20SPACE_X;%0A%0A%20%20%20%20%7D);%0A%0A%20%20%20%20cur_x%20=%20START_POS_X;%0A%20%20%20%20cur_y%20=%20window.editor.getShapePageBounds(shape_id).maxY%20+%20SPACE_Y;%0A%0A%20%20%7D);%0A%7D%0A%0Afunction%20create_modal()%20%7B%0A%20%20var%20modal%20=%20document.createElement('div');%0A%20%20modal.innerHTML%20=%20%60%0A%20%20%20%20%20%20%3Cstyle%3E%0A%20%20%20%20%20%20%20%20#tltxt-modal%20%7B%0A%20%20%20%20%20%20%20%20%20%20display:%20none;%0A%20%20%20%20%20%20%20%20%20%20position:%20fixed;%0A%20%20%20%20%20%20%20%20%20%20z-index:%209999;%0A%20%20%20%20%20%20%20%20%20%20left:%200;%0A%20%20%20%20%20%20%20%20%20%20top:%200;%0A%20%20%20%20%20%20%20%20%20%20width:%20100%25;%0A%20%20%20%20%20%20%20%20%20%20height:%20100%25;%0A%20%20%20%20%20%20%20%20%20%20overflow:%20auto;%0A%20%20%20%20%20%20%20%20%20%20background-color:%20rgba(0,0,0,0.4);%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20.modal-content%20%7B%0A%20%20%20%20%20%20%20%20%20%20background-color:%20#fefefe;%0A%20%20%20%20%20%20%20%20%20%20margin:%2020px%20auto;%0A%20%20%20%20%20%20%20%20%20%20padding:%200;%0A%20%20%20%20%20%20%20%20%20%20border:%201px%20solid%20#888;%0A%20%20%20%20%20%20%20%20%20%20width:%2080%25;%0A%20%20%20%20%20%20%20%20%20%20max-width:%20600px;%0A%20%20%20%20%20%20%20%20%20%20border-radius:%2010px;%0A%20%20%20%20%20%20%20%20%20%20box-shadow:%200%204px%208px%20rgba(0,0,0,0.1);%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20.modal-header%20%7B%0A%20%20%20%20%20%20%20%20%20%20background-color:%20#007A50;%0A%20%20%20%20%20%20%20%20%20%20color:%20white;%0A%20%20%20%20%20%20%20%20%20%20padding:%200%200%2010px%200;%0A%20%20%20%20%20%20%20%20%20%20text-align:%20center;%0A%20%20%20%20%20%20%20%20%20%20border-top-left-radius:%2010px;%0A%20%20%20%20%20%20%20%20%20%20border-top-right-radius:%2010px;%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20.modal-body%20%7B%0A%20%20%20%20%20%20%20%20%20%20padding:%2020px;%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20.modal-footer%20%7B%0A%20%20%20%20%20%20%20%20%20%20background-color:%20#e5e5e5;%0A%20%20%20%20%20%20%20%20%20%20padding:%2010px;%0A%20%20%20%20%20%20%20%20%20%20display:%20flex;%0A%20%20%20%20%20%20%20%20%20%20justify-content:%20space-between;%0A%20%20%20%20%20%20%20%20%20%20align-items:%20center;%0A%20%20%20%20%20%20%20%20%20%20border-bottom-left-radius:%2010px;%0A%20%20%20%20%20%20%20%20%20%20border-bottom-right-radius:%2010px;%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20button%20%7B%0A%20%20%20%20%20%20%20%20%20%20padding:%2010px%2020px;%0A%20%20%20%20%20%20%20%20%20%20border:%20none;%0A%20%20%20%20%20%20%20%20%20%20border-radius:%205px;%0A%20%20%20%20%20%20%20%20%20%20cursor:%20pointer;%0A%20%20%20%20%20%20%20%20%20%20font-size:%2016px;%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20#okButton%20%7B%0A%20%20%20%20%20%20%20%20%20%20background-color:%20#409614;%0A%20%20%20%20%20%20%20%20%20%20color:%20white;%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20#cancelButton%20%7B%0A%20%20%20%20%20%20%20%20%20%20background-color:%20#D93526;%0A%20%20%20%20%20%20%20%20%20%20color:%20white;%0A%20%20%20%20%20%20%20%20%20%20margin-left:%2010px;%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20.two-columns%20%7B%0A%20%20%20%20%20%20%20%20%20%20display:%20flex;%0A%20%20%20%20%20%20%20%20%20%20justify-content:%20space-between;%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20.column%20%7B%0A%20%20%20%20%20%20%20%20%20%20flex-basis:%2045%25;%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20label%20%7B%0A%20%20%20%20%20%20%20%20%20%20display:%20block;%0A%20%20%20%20%20%20%20%20%20%20margin-bottom:%205px;%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20input%5Btype=%22number%22%5D,%20select%20%7B%0A%20%20%20%20%20%20%20%20%20%20width:%20100%25;%0A%20%20%20%20%20%20%20%20%20%20margin-bottom:%2010px;%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20textarea%20%7B%0A%20%20%20%20%20%20%20%20%20%20width:%20100%25;%0A%20%20%20%20%20%20%20%20%20%20margin-top:%2010px;%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20@media%20screen%20and%20(max-width:%20768px)%20%7B%0A%20%20%20%20%20%20%20%20%20%20.two-columns%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20flex-direction:%20column;%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20.column%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20flex-basis:%20100%25;%0A%20%20%20%20%20%20%20%20%20%20%20%20margin-bottom:%2010px;%0A%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%3C/style%3E%0A%20%20%20%20%20%20%3Cdiv%20id=%22tltxt-modal%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20class=%22modal-content%22%3E%0A%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class=%22modal-header%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Ch2%3ETLTXT%20Settings%3C/h2%3E%0A%20%20%20%20%20%20%20%20%20%20%3C/div%3E%0A%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class=%22modal-body%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class=%22two-columns%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class=%22column%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Clabel%20for=%22start_pos_x%22%3EStart%20at%20position%20X:%3C/label%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cinput%20type=%22number%22%20id=%22start_pos_x%22%20value=%22$%7BSTART_POS_X%20%7C%7C%200%7D%22%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Clabel%20for=%22start_pos_y%22%3EStart%20at%20position%20Y:%3C/label%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cinput%20type=%22number%22%20id=%22start_pos_y%22%20value=%22$%7BSTART_POS_Y%20%7C%7C%200%7D%22%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Clabel%20for=%22space_x%22%3EWord%20spacing%20(px):%3C/label%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cinput%20type=%22number%22%20id=%22space_x%22%20value=%22$%7BSPACE_X%20%7C%7C%200%7D%22%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Clabel%20for=%22space_y%22%3ELine%20spacing%20(px):%3C/label%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cinput%20type=%22number%22%20id=%22space_y%22%20value=%22$%7BSPACE_Y%20%7C%7C%200%7D%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class=%22column%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Clabel%20for=%22wrap_text%22%3EWrap%20text:%3C/label%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cinput%20type=%22checkbox%22%20id=%22wrap_text%22%20checked%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Clabel%20for=%22text_max_char_width%22%3EText%20wrap%20characters%20width:%3C/label%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cinput%20type=%22number%22%20id=%22text_max_char_width%22%20value=%22$%7BTEXT_MAX_CHAR_WIDTH%20%7C%7C%200%7D%22%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Clabel%20for=%22add_blank_lines%22%3EAdd%20blank%20lines:%3C/label%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cinput%20type=%22checkbox%22%20id=%22add_blank_lines%22%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Clabel%20for=%22text_color%22%3EText%20color:%3C/label%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cselect%20id=%22text_color%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Coption%20value=%22white%22%20selected%3EWhite%3C/option%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Coption%20value=%22black%22%3EBlack%3C/option%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C/select%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Clabel%20for=%22text_size_style%22%3EText%20size:%3C/label%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cselect%20id=%22text_size_style%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Coption%20value=%22l%22%3ELarge%3C/option%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Coption%20value=%22m%22%20selected%3EMedium%3C/option%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Coption%20value=%22s%22%3ESmall%3C/option%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Coption%20value=%22xl%22%3EExtra%20Large%3C/option%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C/select%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C/div%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C/div%3E%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Clabel%20for=%22insert_text%22%3EText%20to%20insert:%3C/label%3E%3Cbr%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Ctextarea%20id=%22insert_text%22%20rows=%2210%22%20cols=%2240%22%3E$%7BINSERT_TEXT%20%7C%7C%200%7D%3C/textarea%3E%0A%20%20%20%20%20%20%20%20%20%20%3C/div%3E%0A%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class=%22modal-footer%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cbutton%20id=%22cancelButton%22%3ECancel%3C/button%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cbutton%20id=%22okButton%22%3EOK%3C/button%3E%0A%20%20%20%20%20%20%20%20%20%20%3C/div%3E%0A%20%20%20%20%20%20%20%20%3C/div%3E%0A%20%20%20%20%20%20%3C/div%3E%0A%20%20%20%20%60;%0A%0A%20%20document.body.appendChild(modal);%0A%0A%20%20modal.querySelector('#okButton').addEventListener('click',%20set_tltxt_values);%0A%20%20modal.querySelector('#cancelButton').addEventListener('click',%20close_modal);%0A%0A%20%20return%20modal.querySelector('#tltxt-modal');%0A%7D%0A%0Afunction%20close_modal()%20%7B%0A%20%20var%20modal%20=%20document.getElementById('tltxt-modal');%0A%20%20modal.style.display%20=%20'none';%0A%7D%0A%0Afunction%20set_tltxt_values()%20%7B%0A%20%20START_POS_X%20=%20Number(document.getElementById('start_pos_x').value);%0A%20%20START_POS_Y%20=%20Number(document.getElementById('start_pos_y').value);%0A%20%20SPACE_X%20=%20Number(document.getElementById('space_x').value);%0A%20%20SPACE_Y%20=%20Number(document.getElementById('space_y').value);%0A%20%20WRAP_TEXT%20=%20document.getElementById('wrap_text').checked;%0A%20%20TEXT_MAX_CHAR_WIDTH%20=%20Number(document.getElementById('text_max_char_width').value);%0A%0A%20%20TEXT_SIZE_STYLE%20=%20document.getElementById('text_size_style').value;%0A%20%20TEXT_COLOR%20=%20document.getElementById('text_color').value;%0A%20%20ADD_BLANK_LINES%20=%20document.getElementById('add_blank_lines').checked;%0A%20%20INSERT_TEXT%20=%20document.getElementById('insert_text').value;%0A%0A%20%20close_modal();%0A%20%20tldraw_text_insert(INSERT_TEXT);%0A%7D%0A%0Afunction%20open_modal()%20%7B%0A%20%20var%20modal%20=%20document.getElementById('tltxt-modal');%0A%20%20if%20(!modal)%20%7B%0A%20%20%20%20modal%20=%20create_modal();%0A%20%20%7D%0A%20%20modal.style.display%20=%20'block';%0A%7D%0A%0Anavigator.clipboard%0A%20%20%20%20.readText()%0A%20%20%20%20.then((text)%20=%3E%20%7B%0A%20%20%20%20%20%20INSERT_TEXT%20=%20text;%0A%20%20%20%20%20%20open_modal();%0A%20%20%20%20%7D);%0A%7D)()" class="bookmarklet-name mdl-color--primary mdl-color-text--accent-contrast">TLTXT</a>
        </p>

        <p>Copy some text, change tabs to tldraw.com and click on the bookmarklet.</p>
        <p>A modal dialog with settings should appear, which control the text spacing and other options.</p>
        <p>The text to be inserted is taken from the clipboard and shown in the dialog text input, where it can be edited before inserting.</p>
        <p>The code breaks the text to words and inserts them into the current tldraw board.</p>
    </body>
</html>
